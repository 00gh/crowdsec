#!/bin/sh
set -e

CAPI=/etc/crowdsec/online_api_credentials.yaml
LAPI=/etc/crowdsec/local_api_credentials.yaml

if [ "$1" = purge ]; then
  # Created by the postinst during LAPI registration:
  rm -f "$LAPI"

  # Might have been created by the postinst during CAPI registration,
  # or created by the admin to prevent CAPI registration. Delete only
  # when chances are high this was generated by the CAPI registration:
  if [ -f "$CAPI" ] && grep -qs '^url: https://api.crowdsec.net/$' "$CAPI"; then
    rm -f "$CAPI"
  fi

  rmdir /etc/crowdsec 2>/dev/null || true

  # Local config and hub:
  rm -rf /var/lib/crowdsec/data
  rm -rf /var/lib/crowdsec/hub
fi

#DEBHELPER#
